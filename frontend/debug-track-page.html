<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Track Page - RoadRescue360</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .debug-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-button {
            background: #0056b3;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            display: inline-block;
            text-decoration: none;
        }
        .test-button:hover {
            background: #004494;
        }
        .test-button.secondary {
            background: #28a745;
        }
        .test-button.secondary:hover {
            background: #218838;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }
        .error {
            background: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid #e9ecef;
            max-height: 300px;
            overflow-y: auto;
        }
        .element-test {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #0056b3;
        }
        .element-test.found {
            border-left-color: #28a745;
            background: #e8f5e8;
        }
        .element-test.not-found {
            border-left-color: #dc3545;
            background: #ffebee;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>üîç Debug Track Page - RoadRescue360</h1>
        <p>This page helps debug why the track page is not updating service details.</p>
        
        <div class="status" id="status">
            Ready to debug the track page. Click the buttons below to test each component.
        </div>
        
        <h3>Test Actions:</h3>
        <button class="test-button" onclick="setTestData()">üìù Set Test Booking Data</button>
        <button class="test-button" onclick="checkLocalStorage()">üíæ Check localStorage</button>
        <button class="test-button" onclick="testElementSelection()">üéØ Test Element Selection</button>
        <button class="test-button secondary" onclick="goToTrackPage()">üì± Go to Track Page</button>
        <button class="test-button secondary" onclick="simulateLoadBookingData()">üîÑ Simulate loadBookingData()</button>
        
        <h3>Element Tests:</h3>
        <div id="elementTests">Click "Test Element Selection" to check if elements exist.</div>
        
        <h3>Debug Information:</h3>
        <pre id="debugInfo">No debug information yet.</pre>
        
        <h3>Current localStorage Data:</h3>
        <pre id="localStorageData">No data found.</pre>
    </div>
    <script src="config.js"></script>
    <script>
        // Set test booking data
        function setTestData() {
            const testData = {
                service: 'fuel',
                serviceTitle: 'Fuel Delivery',
                servicePricing: 'Starting at ‚Çπ999',
                serviceDescription: 'Emergency fuel delivery service to get you back on the road.',
                serviceIcon: '<i class="fas fa-gas-pump"></i>',
                name: 'Test User',
                phone: '+91 9876543210',
                location: 'Sector 62, Noida, Uttar Pradesh 201301, India',
                vehicleInfo: 'Honda City - White - DL-01-AB-1234',
                time: 'ASAP',
                paymentMethod: 'Credit Card',
                notes: 'Test booking for debugging',
                timestamp: new Date().toISOString(),
                trackingId: 'RR-' + Math.floor(Math.random() * 1000000)
            };
            
            localStorage.setItem('roadRescueBooking', JSON.stringify(testData));
            document.getElementById('status').innerHTML = `
                ‚úÖ <strong>Test booking data set!</strong><br>
                Service: <strong>${testData.serviceTitle}</strong><br>
                Tracking ID: <strong>${testData.trackingId}</strong>
            `;
            
            checkLocalStorage();
        }
        
        // Check localStorage data
        function checkLocalStorage() {
            const bookingData = localStorage.getItem('roadRescueBooking');
            
            if (bookingData) {
                const data = JSON.parse(bookingData);
                document.getElementById('localStorageData').textContent = JSON.stringify(data, null, 2);
            } else {
                document.getElementById('localStorageData').textContent = 'No booking data found in localStorage.';
            }
        }
        
        // Test element selection (simulate track page elements)
        function testElementSelection() {
            const elementTests = document.getElementById('elementTests');
            elementTests.innerHTML = '';
            
            // Create mock elements to test
            const mockElements = [
                { id: 'displayTrackingId', text: 'RR-124578' },
                { class: 'detail-value', text: 'Battery Jump Start' },
                { id: 'service-name', text: 'Battery Jump Start Service' },
                { id: 'service-price', text: '‚Çπ699.00' },
                { class: 'technician-badge', text: 'Battery Specialist' }
            ];
            
            mockElements.forEach((element, index) => {
                const testDiv = document.createElement('div');
                testDiv.className = 'element-test';
                
                if (element.id) {
                    const mockElement = document.createElement('span');
                    mockElement.id = element.id;
                    mockElement.textContent = element.text;
                    testDiv.appendChild(mockElement);
                    testDiv.innerHTML += `<strong>ID: ${element.id}</strong> - Text: "${element.text}"`;
                } else if (element.class) {
                    const mockElement = document.createElement('span');
                    mockElement.className = element.class;
                    mockElement.textContent = element.text;
                    testDiv.appendChild(mockElement);
                    testDiv.innerHTML += `<strong>Class: ${element.class}</strong> - Text: "${element.text}"`;
                }
                
                elementTests.appendChild(testDiv);
            });
            
            document.getElementById('debugInfo').textContent = `
Element Selection Test Results:
‚úÖ Created mock elements for testing
‚úÖ Elements are now available in the DOM
‚úÖ Ready to test loadBookingData() function
            `;
        }
        
        // Go to track page
        function goToTrackPage() {
            window.location.href = 'track-service.html';
        }
        
        // Simulate the loadBookingData function
        function simulateLoadBookingData() {
            try {
                const bookingData = localStorage.getItem('roadRescueBooking');
                console.log('Raw booking data:', bookingData);
                
                if (bookingData) {
                    const data = JSON.parse(bookingData);
                    console.log('Parsed booking data:', data);
                    
                    let debugOutput = `loadBookingData() Simulation Results:\n\n`;
                    debugOutput += `‚úÖ Raw booking data found: ${bookingData ? 'Yes' : 'No'}\n`;
                    debugOutput += `‚úÖ Parsed booking data: ${JSON.stringify(data, null, 2)}\n\n`;
                    
                    // Test element selection
                    const elements = [
                        { selector: '#displayTrackingId', name: 'Tracking ID Display' },
                        { selector: '.detail-value', name: 'Service Type (detail-value)' },
                        { selector: '#service-name', name: 'Service Name in Cost' },
                        { selector: '#service-price', name: 'Service Price in Cost' },
                        { selector: '.technician-badge', name: 'Technician Badge' }
                    ];
                    
                    elements.forEach(element => {
                        const foundElement = document.querySelector(element.selector);
                        if (foundElement) {
                            debugOutput += `‚úÖ ${element.name}: Found (${element.selector})\n`;
                            debugOutput += `   Current text: "${foundElement.textContent.trim()}"\n`;
                            
                            // Test updating the element
                            if (element.selector === '#displayTrackingId' && data.trackingId) {
                                foundElement.textContent = data.trackingId;
                                debugOutput += `   ‚úÖ Updated to: "${data.trackingId}"\n`;
                            } else if (element.selector === '.detail-value' && data.serviceTitle) {
                                if (foundElement.textContent.trim() === 'Battery Jump Start') {
                                    foundElement.textContent = data.serviceTitle;
                                    debugOutput += `   ‚úÖ Updated to: "${data.serviceTitle}"\n`;
                                } else {
                                    debugOutput += `   ‚ö†Ô∏è Text doesn't match "Battery Jump Start"\n`;
                                }
                            } else if (element.selector === '#service-name' && data.serviceTitle) {
                                foundElement.textContent = data.serviceTitle + ' Service';
                                debugOutput += `   ‚úÖ Updated to: "${data.serviceTitle} Service"\n`;
                            } else if (element.selector === '#service-price' && data.service) {
                                const baseCosts = {
                                    'battery': 699,
                                    'fuel': 999,
                                    'lockout': 799,
                                    'towing': 1699,
                                    'tire': 899,
                                    'mechanic': 1199
                                };
                                const serviceCost = baseCosts[data.service] || 999;
                                foundElement.textContent = `‚Çπ${serviceCost}.00`;
                                debugOutput += `   ‚úÖ Updated to: "‚Çπ${serviceCost}.00"\n`;
                            } else if (element.selector === '.technician-badge' && data.service) {
                                const serviceSpecialists = {
                                    'battery': 'Battery Specialist',
                                    'fuel': 'Fuel Delivery Specialist',
                                    'lockout': 'Lockout Specialist',
                                    'towing': 'Towing Specialist',
                                    'tire': 'Tire Change Specialist',
                                    'mechanic': 'Mobile Mechanic'
                                };
                                const specialistType = serviceSpecialists[data.service] || 'Service Specialist';
                                foundElement.textContent = specialistType;
                                debugOutput += `   ‚úÖ Updated to: "${specialistType}"\n`;
                            }
                        } else {
                            debugOutput += `‚ùå ${element.name}: Not found (${element.selector})\n`;
                        }
                    });
                    
                    document.getElementById('debugInfo').textContent = debugOutput;
                    
                } else {
                    document.getElementById('debugInfo').textContent = `
loadBookingData() Simulation Results:

‚ùå No booking data found in localStorage
‚ö†Ô∏è Make sure to set test data first using "Set Test Booking Data" button
                    `;
                }
            } catch (error) {
                document.getElementById('debugInfo').textContent = `
loadBookingData() Simulation Results:

‚ùå Error occurred: ${error.message}
‚ùå Stack trace: ${error.stack}
                `;
            }
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkLocalStorage();
        });
    </script>
</body>
</html>



