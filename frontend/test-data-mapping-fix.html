<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Data Mapping Fix - RoadRescue360</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-button {
            background: #0056b3;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            display: inline-block;
            text-decoration: none;
        }
        .test-button:hover {
            background: #004494;
        }
        .test-button.secondary {
            background: #28a745;
        }
        .test-button.secondary:hover {
            background: #218838;
        }
        .test-button.danger {
            background: #dc3545;
        }
        .test-button.danger:hover {
            background: #c82333;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }
        .error {
            background: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
        }
        .success {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            color: #2e7d32;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
        }
        .data-preview {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
        }
        .field-mapping {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .field-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #0056b3;
        }
        .field-card.correct {
            border-left-color: #28a745;
            background: #e8f5e8;
        }
        .field-card.incorrect {
            border-left-color: #dc3545;
            background: #ffebee;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîß Test Data Mapping Fix - RoadRescue360</h1>
        <p>This page tests the fixed data mapping for service details on the track page.</p>
        
        <div class="status" id="status">
            Ready to test the data mapping fix. Click the button below to set test data and verify correct field mapping.
        </div>
        
        <h3>Test Actions:</h3>
        <button class="test-button" onclick="setTestData()">üìù Set Test Data (Fuel Delivery)</button>
        <button class="test-button" onclick="setBatteryTestData()">üîã Set Battery Test Data</button>
        <button class="test-button secondary" onclick="goToTrackPage()">üì± Go to Track Page</button>
        <button class="test-button danger" onclick="clearData()">üóëÔ∏è Clear Data</button>
        
        <h3>Expected Field Mapping:</h3>
        <div class="field-mapping">
            <div class="field-card correct">
                <h4>‚úÖ Service Type</h4>
                <p><strong>Should show:</strong> "Fuel Delivery"</p>
                <p><strong>Not:</strong> "Sun, 14 Sept, 03:40 am"</p>
            </div>
            <div class="field-card correct">
                <h4>‚úÖ Request Time</h4>
                <p><strong>Should show:</strong> "Sun, Sep 14, 3:40 AM"</p>
                <p><strong>Not:</strong> "28.450984, 77.585499"</p>
            </div>
            <div class="field-card correct">
                <h4>‚úÖ Location</h4>
                <p><strong>Should show:</strong> "Sector 62, Noida, Uttar Pradesh 201301, India"</p>
                <p><strong>Not:</strong> "RR-891545"</p>
            </div>
            <div class="field-card correct">
                <h4>‚úÖ Tracking Number</h4>
                <p><strong>Should show:</strong> "RR-891545"</p>
                <p><strong>Not:</strong> "fdh"</p>
            </div>
            <div class="field-card correct">
                <h4>‚úÖ Special Instructions</h4>
                <p><strong>Should show:</strong> "Test booking for Fuel Delivery service"</p>
                <p><strong>Not:</strong> "Vehicle is parked in basement parking B2, slot #45"</p>
            </div>
        </div>
        
        <h3>Current Test Data:</h3>
        <div class="data-preview" id="dataPreview">No data set yet.</div>
    </div>
    <script src="config.js"></script>
    <script>
        // Set test data for Fuel Delivery
        function setTestData() {
            const testData = {
                service: 'fuel',
                serviceTitle: 'Fuel Delivery',
                servicePricing: 'Starting at ‚Çπ999',
                serviceDescription: 'Emergency fuel delivery service to get you back on the road.',
                serviceIcon: '<i class="fas fa-gas-pump"></i>',
                name: 'Test User',
                phone: '+91 9876543210',
                location: '28.450984, 77.585499', // Coordinates
                vehicleInfo: 'Honda City - White - DL-01-AB-1234',
                time: 'ASAP',
                paymentMethod: 'Credit Card',
                notes: 'Test booking for Fuel Delivery service - Data mapping test',
                timestamp: new Date().toISOString(),
                trackingId: 'RR-' + Math.floor(Math.random() * 1000000)
            };
            
            localStorage.setItem('roadRescueBooking', JSON.stringify(testData));
            updateDataPreview(testData);
            
            document.getElementById('status').innerHTML = `
                ‚úÖ <strong>Fuel Delivery test data set!</strong><br>
                Service: <strong>${testData.serviceTitle}</strong><br>
                Tracking ID: <strong>${testData.trackingId}</strong><br>
                Location: <strong>${testData.location}</strong> (coordinates will be converted to address)
            `;
        }
        
        // Set test data for Battery Jump Start
        function setBatteryTestData() {
            const testData = {
                service: 'battery',
                serviceTitle: 'Battery Jump Start',
                servicePricing: 'Starting at ‚Çπ699',
                serviceDescription: 'Professional battery jump start service.',
                serviceIcon: '<i class="fas fa-battery-half"></i>',
                name: 'Test User',
                phone: '+91 9876543210',
                location: 'Sector 62, Noida, Uttar Pradesh 201301, India', // Address
                vehicleInfo: 'Maruti Swift - Red - DL-02-CD-5678',
                time: 'ASAP',
                paymentMethod: 'UPI',
                notes: 'Test booking for Battery Jump Start service - Data mapping test',
                timestamp: new Date().toISOString(),
                trackingId: 'RR-' + Math.floor(Math.random() * 1000000)
            };
            
            localStorage.setItem('roadRescueBooking', JSON.stringify(testData));
            updateDataPreview(testData);
            
            document.getElementById('status').innerHTML = `
                ‚úÖ <strong>Battery Jump Start test data set!</strong><br>
                Service: <strong>${testData.serviceTitle}</strong><br>
                Tracking ID: <strong>${testData.trackingId}</strong><br>
                Location: <strong>${testData.location}</strong> (address format)
            `;
        }
        
        // Update data preview
        function updateDataPreview(data) {
            const preview = `
Service Details Preview:
‚îú‚îÄ‚îÄ Service Type: ${data.serviceTitle}
‚îú‚îÄ‚îÄ Request Time: ${new Date(data.timestamp).toLocaleString('en-IN', {
    weekday: 'short',
    month: 'short', 
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
    hour12: true
})}
‚îú‚îÄ‚îÄ Location: ${data.location.includes(',') ? 'Sector 62, Noida, Uttar Pradesh 201301, India' : data.location}
‚îú‚îÄ‚îÄ Tracking Number: ${data.trackingId}
‚îî‚îÄ‚îÄ Special Instructions: ${data.notes}

Cost Details:
‚îú‚îÄ‚îÄ Service: ${data.serviceTitle} Service
‚îú‚îÄ‚îÄ Price: ‚Çπ${data.service === 'fuel' ? '999' : '699'}.00
‚îî‚îÄ‚îÄ Technician: ${data.service === 'fuel' ? 'Fuel Delivery Specialist' : 'Battery Specialist'}
            `;
            
            document.getElementById('dataPreview').textContent = preview;
        }
        
        // Go to track page
        function goToTrackPage() {
            window.location.href = 'track-service.html';
        }
        
        // Clear data
        function clearData() {
            localStorage.removeItem('roadRescueBooking');
            document.getElementById('dataPreview').textContent = 'No data set yet.';
            document.getElementById('status').className = 'status warning';
            document.getElementById('status').innerHTML = '‚ö†Ô∏è <strong>Data cleared!</strong> Track page will show default values.';
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            const storedData = localStorage.getItem('roadRescueBooking');
            if (storedData) {
                try {
                    const data = JSON.parse(storedData);
                    updateDataPreview(data);
                    document.getElementById('status').innerHTML = `
                        ‚ÑπÔ∏è <strong>Existing data found!</strong> Click "Go to Track Page" to see the current data mapping.
                    `;
                } catch (e) {
                    console.log('Could not parse stored data');
                }
            }
        });
    </script>
</body>
</html>



